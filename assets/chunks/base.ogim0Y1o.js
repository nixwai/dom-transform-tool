var $=Object.defineProperty;var Y=(i,t,a)=>t in i?$(i,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[t]=a;var u=(i,t,a)=>Y(i,typeof t!="symbol"?t+"":t,a);import{d as P,p as h,c as X,o as w,a as V,j as r,af as m,ak as p,Z as T,F as R,_ as U}from"./framework.DraZOub8.js";import{i as x,f as D,a as M,c as k}from"./update-style.Di614ZlN.js";function C(i){!i.scaleAxisParams.x.manualValue&&!i.scaleAxisParams.y.manualValue||(i.options.direction==="x"?L(i):i.options.direction==="y"?I(i):j(i))}function L(i){const{scaleAxisParams:t,scaleHandler:a,scaleLogger:s,scaleStyleUpdater:l}=i,c=s.x.total,n=a.scaling(t.x.manualValue+c,"x"),e=s.y.value;if(!s.x.ratio)return;const o=l.setStyleScale(n,e);i.updateScale({scaleX:n,scaleY:e},o)}function I(i){const{scaleAxisParams:t,scaleHandler:a,scaleLogger:s,scaleStyleUpdater:l}=i,c=s.y.total,n=s.x.value,e=a.scaling(t.y.manualValue+c,"y");if(!s.y.ratio)return;const o=l.setStyleScale(n,e);i.updateScale({scaleX:n,scaleY:e},o)}function j(i){const{scaleAxisParams:t,scaleHandler:a,scaleLogger:s,scaleStyleUpdater:l}=i,c=s.x.total,n=s.y.total,e=a.scaling(t.x.manualValue+c,"x"),o=a.scaling(t.y.manualValue+n,"y");if(!s.x.ratio&&!s.y.ratio)return;const d=l.setStyleScale(e,o);i.updateScale({scaleX:e,scaleY:o},d)}class B{constructor(t,a){u(this,"x",{originValue:1,minValue:-1/0,maxValue:1/0,manualValue:0});u(this,"y",{originValue:1,minValue:-1/0,maxValue:1/0,manualValue:0});this.options=t,this.scaleDomAttrs=a,this.setManualValue(),this.setAxisParams()}setManualValue(){var t;if(((t=this.options.manual)==null?void 0:t.scale)!==void 0){const{scaleX:a,scaleY:s}=this.scaleDomAttrs.variant,l=x(this.options.manual.scale);this.x.manualValue=this.resolveManualValue(a,l[0]),this.y.manualValue=this.resolveManualValue(s,l[1])}else this.x.manualValue=0,this.y.manualValue=0}setAxisParams(){const{originScaleX:t,originScaleY:a,minScaleX:s,maxScaleX:l,minScaleY:c,maxScaleY:n,variant:e}=this.scaleDomAttrs;this.x.originValue=t,this.x.maxValue=l-e.scaleX,this.x.minValue=s-e.scaleX,this.y.originValue=a,this.y.maxValue=n-e.scaleY,this.y.minValue=c-e.scaleY}resolveManualValue(t,a){var l;let s=a;return((l=this.options.manual)==null?void 0:l.mode)==="absolute"&&(s=s-t),s}}class H{constructor(t){u(this,"variant",new D);u(this,"originScaleX",1);u(this,"originScaleY",1);u(this,"minScaleX",-1/0);u(this,"minScaleY",-1/0);u(this,"maxScaleX",1/0);u(this,"maxScaleY",1/0);this.options=t,this.updateTargetAttrsInfo(),this.updateScaleInfo(),this.customDomAttrs()}updateTargetAttrsInfo(){if(!this.options.target)return;const t=window.getComputedStyle(this.options.target,null);this.variant.setTransform(t),this.variant.setScale(t)}updateScaleInfo(){this.options.scaleType==="transform"?(this.originScaleX=this.variant.transformScaleX,this.originScaleY=this.variant.transformScaleY):(this.originScaleX=this.variant.styleScaleX,this.originScaleY=this.variant.styleScaleY)}customDomAttrs(){if(!this.options.customStyle)return;const{scale:t,maxScale:a,minScale:s}=this.options.customStyle;if(t!==void 0){const l=x(t);this.originScaleX=l[0],this.originScaleY=l[1]}if(a!==void 0){const l=x(a);this.maxScaleX=l[0],this.maxScaleY=l[1]}if(s!==void 0){const l=x(s);this.minScaleX=l[0],this.minScaleY=l[1]}}}class N{constructor(t,a){this.scaleAxisParams=t,this.scaleLogger=a}scaling(t,a){const{minValue:s,maxValue:l,originValue:c}=this.scaleAxisParams[a];let n=t;return n<s?n=s:n>l&&(n=l),n=M(n+c),this.scaleLogger.logRatio(n,a),n}}class F{constructor(t){u(this,"x",{value:0,total:0,ratio:0});u(this,"y",{value:0,total:0,ratio:0});this.scaleAxisParams=t,this.setRatio()}setRatio(){this.x.value=this.scaleAxisParams.x.originValue,this.y.value=this.scaleAxisParams.y.originValue,this.x.total=0,this.y.total=0,this.x.ratio=0,this.y.ratio=0}logRatio(t,a){this[a].ratio=t-this[a].value,this[a].total=t-this.scaleAxisParams[a].originValue,this[a].value=t}}let G=class{constructor(t,a){u(this,"targetRef");u(this,"setStyleScale",()=>({}));this.options=t,this.scaleDomAttrs=a,t.target&&(this.targetRef=new WeakRef(t.target)),this.setStyleScaleUpdater()}setStyleScaleUpdater(){this.setStyleScale=k(this.createGetScaleStyle(),this.targetRef,this.options.disableUpdate)}changeByCustomRender(t){return(a,s)=>{var c;const l=(c=this.options.customRender)==null?void 0:c[t];return(l==null?void 0:l(a,s))??`${a} ${s}`}}createGetScaleStyle(){const t=this.changeByCustomRender("scale");if(this.options.scaleType==="transform"){const{transformName:a,transformValue:s,transformRotate:l}=this.scaleDomAttrs.variant;let c="";const n=s.length>6;n?c=s.slice(6).join(","):c=s.slice(4).join(",");const e=Math.cos(l*Math.PI/180),o=Math.sin(l*Math.PI/180);return(d,S)=>{const y=e*d,g=o*d,v=-o*S,f=e*S,b=n?`${y},${g},${s[2]},${s[3]},${v},${f}`:`${y},${g},${v},${f}`;return{transform:`${a}(${b},${c})`}}}else return(a,s)=>({scale:t(a,s)})}};class W{constructor(t){u(this,"options",{});u(this,"scaleDomAttrs");u(this,"scaleAxisParams");u(this,"scaleLogger");u(this,"scaleStyleUpdater");u(this,"scaleHandler");t&&(this.options=t),this.scaleDomAttrs=new H(this.options),this.scaleAxisParams=new B(this.options,this.scaleDomAttrs),this.scaleLogger=new F(this.scaleAxisParams),this.scaleStyleUpdater=new G(this.options,this.scaleDomAttrs),this.scaleHandler=new N(this.scaleAxisParams,this.scaleLogger)}updateScale(t,a){var s,l;(l=(s=this.options).callback)==null||l.call(s,t,a)}}function A(i){const t=new W(i);C(t)}const E={class:"flex gap-1 mt-4"},Z={class:"flex gap-1 mt-4"},q={class:"flex mt-4 items-center justify-center flex-col w-40"},z={class:"flex gap-1 items-center justify-center"},J={class:"position-relative h-100"},K=P({__name:"base",setup(i){const t=h(),a=h("all"),s=h("scale");function l(n){const{deltaY:e}=n,o=e>0?.1:-.1;A({target:t.value,direction:a.value,scaleType:s.value,manual:{scale:o},customStyle:{maxScale:3,minScale:.5}})}function c(n){A({target:t.value,direction:a.value,manual:{scale:[n.x,n.y]},scaleType:s.value,customStyle:{maxScale:3,minScale:.5}})}return(n,e)=>(w(),X(R,null,[e[15]||(e[15]=V(" 使用滚轮放大缩小 ",-1)),r("div",E,[r("div",null,[m(r("input",{id:"all","onUpdate:modelValue":e[0]||(e[0]=o=>a.value=o),type:"radio",name:"scale",value:"all",class:"mb-[3px]"},null,512),[[p,a.value]]),e[9]||(e[9]=r("label",{for:"all"},"all",-1))]),r("div",null,[m(r("input",{id:"x","onUpdate:modelValue":e[1]||(e[1]=o=>a.value=o),type:"radio",name:"scale",value:"x",class:"mb-[3px]"},null,512),[[p,a.value]]),e[10]||(e[10]=r("label",{for:"x"},"x",-1))]),r("div",null,[m(r("input",{id:"y","onUpdate:modelValue":e[2]||(e[2]=o=>a.value=o),type:"radio",name:"scale",value:"y",class:"mb-[3px]"},null,512),[[p,a.value]]),e[11]||(e[11]=r("label",{for:"y"},"y",-1))])]),r("div",Z,[r("div",null,[m(r("input",{id:"scale","onUpdate:modelValue":e[3]||(e[3]=o=>s.value=o),type:"radio",name:"rotateType",value:"scale",class:"mb-[3px]"},null,512),[[p,s.value]]),e[12]||(e[12]=r("label",{for:"scale"},"scale",-1))]),r("div",null,[m(r("input",{id:"transform","onUpdate:modelValue":e[4]||(e[4]=o=>s.value=o),type:"radio",name:"rotateType",value:"transform",class:"mb-[3px]"},null,512),[[p,s.value]]),e[13]||(e[13]=r("label",{for:"transform"},"transform",-1))])]),r("div",q,[r("button",{class:"ctxs-btn",onClick:e[5]||(e[5]=o=>c({x:0,y:-.1}))}," -0.1 "),r("div",z,[r("button",{class:"ctxs-btn",onClick:e[6]||(e[6]=o=>c({x:-.1,y:0}))}," -0.1 "),e[14]||(e[14]=V(" 调整 ",-1)),r("button",{class:"ctxs-btn",onClick:e[7]||(e[7]=o=>c({x:.1,y:0}))}," +0.1 ")]),r("button",{class:"ctxs-btn",onClick:e[8]||(e[8]=o=>c({x:0,y:.1}))}," +0.1 ")]),r("div",J,[r("div",{ref_key:"scaleTarget1",ref:t,class:"w-30 h-30 position-absolute bg-blue min-w-10 min-h-10 max-w-100 left-[200px] max-h-100 top-[200px]",onWheel:T(l,["stop","prevent"])},null,544)])],64))}}),at=U(K,[["__scopeId","data-v-684a86ca"]]);export{at as default};
